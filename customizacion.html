<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customización de Producto</title>
    <link rel="stylesheet" href="styles/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@interactjs/interactjs@1.10.11/dist/interact.min.js"></script>
</head>
<body>
    <header class="site-header">
        <nav class="navbar">
            <div class="nav-logo">
                <a href="index.html"><img src="img/logos/isologo_blanco.png" alt="Logo"></a>
            </div>
            <div class="nav-items">
                <a href="colecciones.html">Colecciones</a>
                <a href="index.html"><b>Tienda</b></a>
                <a href="comunidad.html">Comunidad</a>
            </div>
            <div class="nav-icons">
                <a href="#"><img src="img/iconos/buscar.png" alt="Search"></a>
                <a href="perfil.html"><img src="img/iconos/perfil.png" alt="Account"></a>
                <a href="#"><img src="img/iconos/cart.png" alt="Cart"></a>
                <button class="menu-toggle">
                    <img src="img/iconos/menu.png" alt="Menu" />
                </button>
            </div>
        </nav>
        <div class="menu-container">
            <button class="close-menu"><b>X</b></button>
            <a href="#tienda"><b>Tienda</b></a>
            <a href="#colecciones">Colecciones</a>
            <a href="#comunidad">Comunidad</a>
        </div>
        <div class="overlay"></div>
    </header>

    <main class="customization-page">
        <div class="sidebar">
            <ul>
                <li><button class="dropdown-btn">Camisetas</button>
                    <div class="dropdown-container">
                        <img src="custom/CAMISETAS/CAMISETA 1/CAMISETA1_BEIGE_DELANTERA.png" alt="Camiseta 1">
                        <img src="custom/CAMISETAS/CAMISETA 1/CAMISETA1_BLANCA_DELANTERA.png" alt="Camiseta 2">
                        <img src="custom/CAMISETAS/CAMISETA 1/CAMISETA1_GRIS_DELANTERA.png" alt="Camiseta 3">
                        <img src="custom/CAMISETAS/CAMISETA 1/CAMISETA1_NEGRA_DELANTERA.png" alt="Camiseta 4">
                    </div>
                </li>
                <li>Sudaderas</li>
                <li>Pantalones</li>
                <li>Gorras</li>
            </ul>
        </div>
        <div class="product-customization">
            <div class="product-image">
                <img src="custom/CAMISETAS/CAMISETA 1/CAMISETA1_BLANCA_DELANTERA.png" alt="Camiseta" id="selected-shirt">
                <div id="uploaded-images"></div>
            </div>
            <div class="product-details">
                <p class="price">12,99 €</p>
                <div class="image-upload">
                    <input type="file" id="upload-image" accept="image/*">
                    <label for="upload-image">Subir Imagen</label>
                </div>
                <p>Nº de imágenes: <span id="image-count">0</span></p>
                <div class="product-info">
                    <label for="nombre">Nombre:</label>
                    <input type="text" id="nombre">
                    <label for="coleccion">Colección:</label>
                    <select id="coleccion">
                        <option value="1">Colección 1</option>
                        <option value="2">Colección 2</option>
                        <option value="3">Colección 3</option>
                        <option value="4">Colección 4</option>
                    </select>
                </div>
                <p>P.V.P: <span class="pvp">99,99 €</span></p>
                <div class="description">
                    <label for="descripcion">Descripción:</label>
                    <textarea id="descripcion" rows="4"></textarea>
                </div>
                <button type="button" class="submit-button">Enviar</button>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <p>&copy; 2024 Phantom Project. Todos los derechos reservados.</p>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var dropdownBtn = document.querySelector('.dropdown-btn');
            var dropdownContainer = document.querySelector('.dropdown-container');
            var selectedShirt = document.getElementById('selected-shirt');
            var uploadImage = document.getElementById('upload-image');
            var uploadedImagesContainer = document.getElementById('uploaded-images');
            var imageCountSpan = document.getElementById('image-count');
            var imageCount = 0;

            dropdownBtn.addEventListener('click', function() {
                dropdownContainer.classList.toggle('show');
            });

            dropdownContainer.addEventListener('click', function(event) {
                if (event.target.tagName === 'IMG') {
                    selectedShirt.src = event.target.src;
                    dropdownContainer.classList.remove('show');
                }
            });

            uploadImage.addEventListener('change', function(event) {
                if (imageCount < 4) {
                    var file = event.target.files[0];
                    if (file) {
                        var reader = new FileReader();
                        reader.onload = function(e) {
                            var img = document.createElement('img');
                            img.src = e.target.result;
                            img.classList.add('uploaded-image');
                            uploadedImagesContainer.appendChild(img);
                            imageCount++;
                            imageCountSpan.textContent = imageCount;

                            interact(img)
                                .draggable({
                                    listeners: {
                                        move(event) {
                                            var target = event.target;
                                            var x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                                            var y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;

                                            target.style.transform = `translate(${x}px, ${y}px)`;

                                            target.setAttribute('data-x', x);
                                            target.setAttribute('data-y', y);
                                        },
                                    },
                                    modifiers: [
                                        interact.modifiers.restrictRect({
                                            restriction: 'parent',
                                            endOnly: true
                                        })
                                    ],
                                })
                                .resizable({
                                    edges: { left: true, right: true, bottom: true, top: true },
                                    listeners: {
                                        move(event) {
                                            var target = event.target;
                                            var x = (parseFloat(target.getAttribute('data-x')) || 0);
                                            var y = (parseFloat(target.getAttribute('data-y')) || 0);

                                            target.style.width = `${event.rect.width}px`;
                                            target.style.height = `${event.rect.height}px`;

                                            x += event.deltaRect.left;
                                            y += event.deltaRect.top;

                                            target.style.transform = `translate(${x}px, ${y}px)`;

                                            target.setAttribute('data-x', x);
                                            target.setAttribute('data-y', y);
                                        }
                                    }
                                });
                        };
                        reader.readAsDataURL(file);
                    }
                } else {
                    alert("Se pueden subir un máximo de 4 imágenes.");
                }
            });
        });
    </script>
</body>
</html>
